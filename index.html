<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta name="theme-color" content="#111827" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="icon-192.png">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <meta property="og:title" content="æ—¥æœ¬èª í•™ìŠµ Â· ìƒì¥ & ì¹˜ì¦ˆ" />
    <meta property="og:description" content="í•œêµ­ì–´ë¡œ ë°°ìš°ëŠ” ì¼ë³¸ì–´ | í€´ì¦ˆ Â· ê²Œì„ Â· ì“°ê¸° Â· ë°°ì§€" />
    <meta property="og:image" content="og-image.png" />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="ko_KR" />
    <title>æ—¥æœ¬èª í•™ìŠµ Â· ìƒì¥ & ì¹˜ì¦ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body class="bg-gradient-to-b from-gray-50 to-gray-100">
    <div id="root"></div>
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => navigator.serviceWorker.register('./sw.js'));
      }
    </script>
    <script type="text/babel">
      const { useEffect, useMemo, useRef, useState } = React;

      const WORDS = [
        { id: 1, level: "N5", topic: "ì¸ì‚¬", ko: "ì•ˆë…•í•˜ì„¸ìš”", ja: "ã“ã‚“ã«ã¡ã¯", reading: "ã“ã‚“ã«ã¡ã¯", romaji: "konnichiwa", script: "kana", pos: "ì¸ì‚¬", example: "ã“ã‚“ã«ã¡ã¯ã€å…ƒæ°—ã§ã™ã‹ã€‚" },
        { id: 2, level: "N5", topic: "ì¸ì‚¬", ko: "ê°ì‚¬í•©ë‹ˆë‹¤", ja: "ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™", reading: "ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™", romaji: "arigatou gozaimasu", script: "kana", pos: "ì¸ì‚¬", example: "æœ¬å½“ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚" },
        { id: 3, level: "N5", topic: "ì¸ì‚¬", ko: "ë¯¸ì•ˆí•©ë‹ˆë‹¤", ja: "ã™ã¿ã¾ã›ã‚“", reading: "ã™ã¿ã¾ã›ã‚“", romaji: "sumimasen", script: "kana", pos: "ì¸ì‚¬", example: "é…ã‚Œã¦ã™ã¿ã¾ã›ã‚“ã€‚" },
        { id: 4, level: "N5", topic: "ëŒ€ë‹µ", ko: "ë„¤/ì˜ˆ", ja: "ã¯ã„", reading: "ã¯ã„", romaji: "hai", script: "kana", pos: "ë¶€ì‚¬", example: "ã¯ã„ã€ã‚ã‹ã‚Šã¾ã—ãŸã€‚" },
        { id: 5, level: "N5", topic: "ëŒ€ë‹µ", ko: "ì•„ë‹ˆì˜¤", ja: "ã„ã„ãˆ", reading: "ã„ã„ãˆ", romaji: "iie", script: "kana", pos: "ë¶€ì‚¬", example: "ã„ã„ãˆã€é•ã„ã¾ã™ã€‚" },
        { id: 6, level: "N5", topic: "ê°ì •", ko: "ì‚¬ë‘", ja: "æ„›", reading: "ã‚ã„", romaji: "ai", script: "kanji", pos: "ëª…ì‚¬", example: "æ„›ã¯å¤§åˆ‡ã§ã™ã€‚" },
        { id: 7, level: "N5", topic: "ì¸ê°„ê´€ê³„", ko: "ì¹œêµ¬", ja: "å‹é”", reading: "ã¨ã‚‚ã ã¡", romaji: "tomodachi", script: "kanji", pos: "ëª…ì‚¬", example: "å‹é”ã«ä¼šã„ã¾ã™ã€‚" },
        { id: 8, level: "N5", topic: "ìƒí™œ", ko: "ë¬¼", ja: "æ°´", reading: "ã¿ãš", romaji: "mizu", script: "kanji", pos: "ëª…ì‚¬", example: "æ°´ã‚’ãã ã•ã„ã€‚" },
        { id: 9, level: "N5", topic: "ìƒí™œ", ko: "ë°¥/ì‹ì‚¬", ja: "ã”é£¯", reading: "ã”ã¯ã‚“", romaji: "gohan", script: "kanji", pos: "ëª…ì‚¬", example: "ã”é£¯ã‚’é£Ÿã¹ã¾ã™ã€‚" },
        { id: 10, level: "N5", topic: "ì¥ì†Œ", ko: "í•™êµ", ja: "å­¦æ ¡", reading: "ãŒã£ã“ã†", romaji: "gakkou", script: "kanji", pos: "ëª…ì‚¬", example: "å­¦æ ¡ã¸è¡Œãã¾ã™ã€‚" },
        { id: 11, level: "N5", topic: "ì§ì—…", ko: "ì„ ìƒë‹˜", ja: "å…ˆç”Ÿ", reading: "ã›ã‚“ã›ã„", romaji: "sensei", script: "kanji", pos: "ëª…ì‚¬", example: "å…ˆç”Ÿã«èãã¾ã™ã€‚" },
        { id: 12, level: "N5", topic: "ì§ì—…", ko: "í•™ìƒ", ja: "å­¦ç”Ÿ", reading: "ãŒãã›ã„", romaji: "gakusei", script: "kanji", pos: "ëª…ì‚¬", example: "ç§ã¯å­¦ç”Ÿã§ã™ã€‚" },
        { id: 13, level: "N5", topic: "ì‹œê°„", ko: "ì˜¤ëŠ˜", ja: "ä»Šæ—¥", reading: "ãã‚‡ã†", romaji: "kyou", script: "kanji", pos: "ëª…ì‚¬", example: "ä»Šæ—¥ã¯å¿™ã—ã„ã§ã™ã€‚" },
        { id: 14, level: "N5", topic: "ì‹œê°„", ko: "ë‚´ì¼", ja: "æ˜æ—¥", reading: "ã‚ã—ãŸ", romaji: "ashita", script: "kanji", pos: "ëª…ì‚¬", example: "æ˜æ—¥ä¼šã„ã¾ã—ã‚‡ã†ã€‚" },
        { id: 15, level: "N5", topic: "ì‹œê°„", ko: "ì–´ì œ", ja: "æ˜¨æ—¥", reading: "ãã®ã†", romaji: "kinou", script: "kanji", pos: "ëª…ì‚¬", example: "æ˜¨æ—¥ã¯é›¨ã§ã—ãŸã€‚" },
        { id: 16, level: "N5", topic: "ë°©í–¥", ko: "ì™¼ìª½", ja: "å·¦", reading: "ã²ã ã‚Š", romaji: "hidari", script: "kanji", pos: "ëª…ì‚¬", example: "å·¦ã«æ›²ê°€ã£ã¦ãã ã•ã„ã€‚" },
        { id: 17, level: "N5", topic: "ë°©í–¥", ko: "ì˜¤ë¥¸ìª½", ja: "å³", reading: "ã¿ã", romaji: "migi", script: "kanji", pos: "ëª…ì‚¬", example: "å³ãŒã‚ã‚Šã¾ã™ã€‚" },
        { id: 18, level: "N5", topic: "ë°©í–¥", ko: "ìœ„", ja: "ä¸Š", reading: "ã†ãˆ", romaji: "ue", script: "kanji", pos: "ëª…ì‚¬", example: "ä¸Šã‚’è¦‹ã¦ã€‚" },
        { id: 19, level: "N5", topic: "ë°©í–¥", ko: "ì•„ë˜", ja: "ä¸‹", reading: "ã—ãŸ", romaji: "shita", script: "kanji", pos: "ëª…ì‚¬", example: "ä¸‹ã«ç½®ã„ã¦ã€‚" },
        { id: 20, level: "N5", topic: "ì‹œê°„", ko: "ì‹œê°„", ja: "æ™‚é–“", reading: "ã˜ã‹ã‚“", romaji: "jikan", script: "kanji", pos: "ëª…ì‚¬", example: "æ™‚é–“ãŒã‚ã‚Šã¾ã™ã‹ã€‚" },
        { id: 21, level: "N5", topic: "ëˆ", ko: "ëˆ", ja: "ãŠé‡‘", reading: "ãŠã‹ã­", romaji: "okane", script: "kanji", pos: "ëª…ì‚¬", example: "ãŠé‡‘ã‚’æ‰•ã„ã¾ã™ã€‚" },
        { id: 22, level: "N5", topic: "êµí†µ", ko: "ì „ì² ", ja: "é›»è»Š", reading: "ã§ã‚“ã—ã‚ƒ", romaji: "densha", script: "kanji", pos: "ëª…ì‚¬", example: "é›»è»Šã«ä¹—ã‚Šã¾ã™ã€‚" },
        { id: 23, level: "N5", topic: "ì§€ëª…", ko: "ë„ì¿„", ja: "æ±äº¬", reading: "ã¨ã†ãã‚‡ã†", romaji: "Toukyou", script: "kanji", pos: "ëª…ì‚¬", example: "æ±äº¬ã¯å¤§ãã„ç”ºã§ã™ã€‚" },
        { id: 24, level: "N5", topic: "ì·¨ë¯¸", ko: "ìŒì•…", ja: "éŸ³æ¥½", reading: "ãŠã‚“ãŒã", romaji: "ongaku", script: "kanji", pos: "ëª…ì‚¬", example: "éŸ³æ¥½ãŒå¥½ãã§ã™ã€‚" },
        { id: 25, level: "N5", topic: "ë™ì‚¬", ko: "ë…¸ë˜í•˜ë‹¤", ja: "æ­Œã†", reading: "ã†ãŸã†", romaji: "utau", script: "kanji", pos: "ë™ì‚¬", example: "ä¸€ç·’ã«æ­Œã„ã¾ã—ã‚‡ã†ã€‚" },
        { id: 26, level: "N5", topic: "ë™ì‚¬", ko: "ë§Œë‚˜ë‹¤", ja: "ä¼šã†", reading: "ã‚ã†", romaji: "au", script: "kanji", pos: "ë™ì‚¬", example: "å‹é”ã«ä¼šã†ã€‚" },
        { id: 27, level: "N5", topic: "ë™ì‚¬", ko: "ê°€ë‹¤", ja: "è¡Œã", reading: "ã„ã", romaji: "iku", script: "kanji", pos: "ë™ì‚¬", example: "å­¦æ ¡ã¸è¡Œãã€‚" },
        { id: 28, level: "N5", topic: "ë™ì‚¬", ko: "ì˜¤ë‹¤", ja: "æ¥ã‚‹", reading: "ãã‚‹", romaji: "kuru", script: "kanji", pos: "ë™ì‚¬", example: "æ˜æ—¥æ¥ã¦ãã ã•ã„ã€‚" },
        { id: 29, level: "N5", topic: "ë™ì‚¬", ko: "ë³´ë‹¤", ja: "è¦‹ã‚‹", reading: "ã¿ã‚‹", romaji: "miru", script: "kanji", pos: "ë™ì‚¬", example: "æ˜ ç”»ã‚’è¦‹ã‚‹ã€‚" },
        { id: 30, level: "N5", topic: "ë™ì‚¬", ko: "ë§Œë“¤ë‹¤", ja: "ä½œã‚‹", reading: "ã¤ãã‚‹", romaji: "tsukuru", script: "kanji", pos: "ë™ì‚¬", example: "æ›²ã‚’ä½œã‚‹ã€‚" },
      ];

      const STORAGE_KEY = "jpAppProgress_v2";
      const nowYMD = () => new Date().toISOString().slice(0, 10);

      function loadProgress(){ try{ const raw=localStorage.getItem(STORAGE_KEY); return raw? JSON.parse(raw): null } catch { return null; } }
      function saveProgress(s){ localStorage.setItem(STORAGE_KEY, JSON.stringify(s)); }
      function nextDue(correct){ const d=new Date(); if(correct) d.setDate(d.getDate()+2); return d.toISOString().slice(0,10); }
      function shuffle(a){ a=[...a]; for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]];} return a; }

      const Mouse = () => <span role="img" aria-label="mouse">ğŸ­</span>;
      const Cheese = () => <span role="img" aria-label="cheese">ğŸ§€</span>;

      function StatBadge({label, value}){ return (<div className="rounded-2xl bg-white border p-3 shadow text-center"><div className="text-sm text-gray-500">{label}</div><div className="text-2xl font-bold">{value}</div></div>); }
      function Badge({name, desc}){ return (<div className="rounded-2xl border bg-white p-3 shadow"><div className="font-semibold">ğŸ… {name}</div><div className="text-sm text-gray-600">{desc}</div></div>); }

      const SCRIPT_STEPS=[
        { key: "kana", label: "íˆë¼ê°€ë‚˜/ê°€íƒ€ì¹´ë‚˜" },
        { key: "kana+romaji", label: "íˆë¼ê°€ë‚˜ + ë¡œë§ˆì" },
        { key: "kanji", label: "í•œì(ì½ê¸° í•¨ê»˜)" },
      ];

      function App(){
        const [state, setState] = useState(loadProgress() || { lastOpenDate:null, streak:0, learnedIds:[], dueMap:{}, stats:{correct:0,wrong:0,gamesWon:0}, week:{start:null,answers:0}, badges:[] });
        const [tab, setTab] = useState("í•™ìŠµ");
        const [today, setToday] = useState(nowYMD());
        const [level, setLevel] = useState("ALL");
        const [topic, setTopic] = useState("ALL");
        const [scriptMode, setScriptMode] = useState("kana");

        function thisWeekStart(){ const d=new Date(); const day=d.getDay(); const delta=(day===0?-6:1-day); d.setDate(d.getDate()+delta); return d.toISOString().slice(0,10); }

        useEffect(()=>{
          const y=nowYMD(); setToday(y);
          const start=thisWeekStart();
          setState(prev=>{ let streak=prev.streak; if(!prev.lastOpenDate) streak=1; else { const diff=(new Date(y)-new Date(prev.lastOpenDate))/86400000; if(diff>=1 && diff<2) streak=prev.streak+1; else if(diff>=2) streak=1; } const week=(!prev.week||prev.week.start!==start)?{start,answers:0}:prev.week; const next={...prev, lastOpenDate:y, streak, week}; saveProgress(next); return next; });
        },[]);

        const levels = React.useMemo(()=>["ALL", ...Array.from(new Set(WORDS.map(w=>w.level)))], []);
        const topics = React.useMemo(()=>["ALL", ...Array.from(new Set(WORDS.map(w=>w.topic)))], []);
        const pool = React.useMemo(()=> WORDS.filter(w => (level==="ALL"||w.level===level) && (topic==="ALL"||w.topic===topic)), [level,topic]);

        const dueIds = React.useMemo(()=>{ const y=today; return Object.entries(state.dueMap).filter(([,d])=>d<=y).map(([id])=>parseInt(id)); }, [state.dueMap, today]);
        const learnedSet = new Set(state.learnedIds);
        const newWords = React.useMemo(()=> pool.filter(w=>!learnedSet.has(w.id)).slice(0,5), [pool, state.learnedIds]);
        const dueWords = React.useMemo(()=> pool.filter(w=> dueIds.includes(w.id)), [pool, dueIds]);
        const todaySet = React.useMemo(()=> shuffle([...newWords, ...dueWords]).slice(0,10), [newWords, dueWords]);

        function awardBadges(next){ const unlocked=new Set(next.badges); const accuracy=(next.stats.correct+next.stats.wrong)?(next.stats.correct/(next.stats.correct+next.stats.wrong)):0; if(next.streak>=7) unlocked.add("í•œ ì£¼ ê°œê·¼"); if(accuracy>=0.9 && (next.stats.correct+next.stats.wrong)>=30) unlocked.add("ì •ë‹µë¥  90% í´ëŸ½"); if(next.stats.gamesWon>=3) unlocked.add("ì¹˜ì¦ˆ ì‚¬ëƒ¥ê¾¼"); if(next.week.answers>=50) unlocked.add("ì£¼ê°„ ì±Œë¦°ì§€ ë‹¬ì„±"); return Array.from(unlocked); }

        function markResult(id, correct){ setState(prev=>{ const learnedIds=prev.learnedIds.includes(id)?prev.learnedIds:[...prev.learnedIds,id]; const dueMap={...prev.dueMap,[id]:nextDue(correct)}; const stats={...prev.stats, correct:prev.stats.correct+(correct?1:0), wrong:prev.stats.wrong+(correct?0:1)}; const week={...prev.week, answers:(prev.week?.answers||0)+1}; const next={...prev, learnedIds, dueMap, stats, week}; next.badges=awardBadges(next); saveProgress(next); return next; }); }

        function RenderWord({w}){ let main=w.ja; if(scriptMode==="kana") main=w.script==="kanji"? w.reading : w.ja; if(scriptMode==="kana+romaji") main=`${w.script==="kanji"? w.reading: w.ja} Â· ${w.romaji}`; if(scriptMode==="kanji") main=`${w.ja} (${w.reading})`; return (<><div className="text-sm text-gray-500">ì¼ë³¸ì–´</div><div className="text-2xl font-bold">{main}</div><div className="text-sm text-gray-500">í•œêµ­ì–´</div><div className="text-base">{w.ko}</div></>); }
        function speakJA(t){ if(!("speechSynthesis" in window)) return alert("ë¸Œë¼ìš°ì €ê°€ TTSë¥¼ ì§€ì›í•˜ì§€ ì•Šì•„ìš”"); const u=new SpeechSynthesisUtterance(t); u.lang="ja-JP"; u.rate=0.95; const v=speechSynthesis.getVoices().find(v=>v.lang.startsWith("ja")); if(v) u.voice=v; speechSynthesis.cancel(); speechSynthesis.speak(u); }

        function Quiz(){ const [i,setI]=useState(0); const [mode,setMode]=useState("ê°ê´€ì‹"); const items=todaySet.length? todaySet: shuffle(pool).slice(0,10); const cur=items[i%items.length]; const choices=React.useMemo(()=>{ const p=shuffle(pool.filter(w=>w.id!==cur.id)).slice(0,3); return shuffle([...p,cur]).map(w=>({id:w.id,label:`${w.ja} (${w.reading})`})); },[cur]); const [ans,setAns]=useState(""); const [fb,setFb]=useState(""); function next(ok){ markResult(cur.id, ok); setFb(ok? "ì •ë‹µ!": `ì˜¤ë‹µâ€¦ ì •ë‹µ: ${cur.ja}`); setTimeout(()=>{ setFb(""); setAns(""); setI(x=>x+1); }, 700); } return (<div className="space-y-4"><div className="flex items-center justify-between gap-3 flex-wrap"><div className="text-lg">ì˜¤ëŠ˜ì˜ í€´ì¦ˆ Â· {i+1}/{items.length}</div><div className="flex gap-2">{["ê°ê´€ì‹","íƒ€ì"].map(m=><button key={m} onClick={()=>setMode(m)} className={`px-3 py-1 rounded-2xl border ${mode===m?"bg-black text-white":"bg-white"}`}>{m}</button>)}<button onClick={()=>speakJA(cur.ja)} className="px-3 py-1 rounded-2xl border">ğŸ”Š ë°œìŒ</button></div></div><div className="rounded-2xl bg-white border p-4 shadow"><RenderWord w={cur}/><div className="text-sm text-gray-500 mt-2">ì˜ˆë¬¸</div><div className="text-base">{cur.example}</div></div>{mode==="ê°ê´€ì‹"? (<div className="grid md:grid-cols-2 gap-3">{choices.map(c=>(<button key={c.id} onClick={()=>next(c.id===cur.id)} className="rounded-2xl bg-white border p-3 shadow text-left hover:scale-[1.01] transition"><div className="text-lg">{c.label}</div></button>))}</div>) : (<div className="flex flex-col gap-3"><input className="border rounded-2xl p-3" placeholder="ì •ë‹µ(ì¼ë³¸ì–´)ì„ ì…ë ¥í•˜ì„¸ìš”" value={ans} onChange={e=>setAns(e.target.value)} onKeyDown={e=> e.key==='Enter' && next(ans.trim()===cur.ja)} /><div className="flex gap-2"><button onClick={()=>next(ans.trim()===cur.ja)} className="px-4 py-2 rounded-2xl bg-black text-white">í™•ì¸</button><button onClick={()=>speakJA(cur.ja)} className="px-4 py-2 rounded-2xl border">ğŸ”Š ë°œìŒ</button></div></div>)}{fb && <div className="text-center text-lg">{fb}</div>}</div>); }

        function Learn(){ const items=todaySet.length? todaySet: pool.slice(0,10); return (<div className="space-y-4"><div className="flex flex-wrap gap-2 items-center"><select className="border rounded-2xl px-3 py-2" value={level} onChange={e=>setLevel(e.target.value)}>{levels.map(l=><option key={l} value={l}>{l}</option>)}</select><select className="border rounded-2xl px-3 py-2" value={topic} onChange={e=>setTopic(e.target.value)}>{topics.map(t=><option key={t} value={t}>{t}</option>)}</select><div className="flex gap-2">{SCRIPT_STEPS.map(s=>(<button key={s.key} onClick={()=>setScriptMode(s.key)} className={`px-3 py-2 rounded-2xl border ${scriptMode===s.key?"bg-black text-white":"bg-white"}`}>{s.label}</button>))}</div></div><div className="grid md:grid-cols-2 gap-4">{items.map(w=>(<div key={w.id} className="rounded-2xl bg-white border p-4 shadow space-y-2"><RenderWord w={w}/><div className="text-sm text-gray-500">í’ˆì‚¬/ë ˆë²¨/í† í”½</div><div className="text-base">{w.pos} Â· {w.level} Â· {w.topic}</div><div className="text-sm text-gray-500">ì˜ˆë¬¸</div><div className="text-base">{w.example}</div><div className="flex gap-2 pt-2"><button className="px-3 py-1 rounded-2xl border" onClick={()=>speakJA(w.ja)}>ğŸ”Š ë°œìŒ</button><button className="px-3 py-1 rounded-2xl border" onClick={()=>markResult(w.id, true)}>í•™ìŠµì™„ë£Œ</button></div></div>))}</div></div>); }

        function Game(){ const size=5; const [mouse,setMouse]=useState({x:0,y:0}); const [cheese,setCheese]=useState({x:size-1,y:size-1}); const [current,setCurrent]=useState(()=> shuffle(todaySet.length? todaySet: pool).slice(0,10)); const [qIndex,setQIndex]=useState(0); const word=current[qIndex%current.length]; const options=React.useMemo(()=>{ const p=shuffle(pool.filter(w=>w.id!==word.id)).slice(0,3); return shuffle([...p, word]); }, [word]); function move(){ setMouse(m=>({x: m.x + Math.sign(cheese.x-m.x), y: m.y + Math.sign(cheese.y-m.y)})); } const win=mouse.x===cheese.x && mouse.y===cheese.y; useEffect(()=>{ if(win){ setState(prev=>{ const next={...prev, stats:{...prev.stats, gamesWon:prev.stats.gamesWon+1}}; saveProgress(next); return next;}); }}, [win]); return (<div className="space-y-4"><div className="text-lg">ğŸ­ ìƒì¥ë¥¼ ğŸ§€ ì¹˜ì¦ˆê¹Œì§€ Â· ë¬¸ì œ {qIndex+1}/{current.length}</div><div className="grid grid-cols-5 gap-2 w-max">{Array.from({length:size*size}).map((_,i)=>{ const x=i%size, y=Math.floor(i/size); const isM=mouse.x===x && mouse.y===y; const isC=cheese.x===x && cheese.y===y; return (<div key={i} className={`h-14 w-14 rounded-2xl border flex items-center justify-center bg-white ${isC?"bg-yellow-50":""}`}>{isM? <Mouse/> : isC? <Cheese/> : <span className="text-xs text-gray-300">Â·</span>}</div>); })}</div>{win? (<div className="rounded-2xl bg-green-50 border p-4"><div className="text-lg font-semibold">ì„±ê³µ! ì¹˜ì¦ˆë¥¼ ì°¾ì•˜ì–´ìš”! ğŸ§€</div><button className="mt-2 px-4 py-2 rounded-2xl bg-black text-white" onClick={()=>{ setMouse({x:0,y:0}); setCheese({x:size-1,y:size-1}); setQIndex(0); setCurrent(shuffle(pool).slice(0,10)); }}>ë‹¤ì‹œ í•˜ê¸°</button></div>) : (<div className="rounded-2xl bg-white border p-4 shadow"><div className="flex items-center justify-between"><div><div className="text-sm text-gray-500">í•œêµ­ì–´ ëœ»</div><div className="text-xl font-semibold">{word.ko}</div></div><button onClick={()=>speakJA(word.ja)} className="px-3 py-1 rounded-2xl border">ğŸ”Š ë°œìŒ</button></div><div className="grid md:grid-cols-2 gap-3 mt-3">{options.map(o=>(<button key={o.id} onClick={()=>{ const ok=o.id===word.id; markResult(word.id, ok); if(ok){ move(); setQIndex(i=>i+1); } }} className="rounded-2xl bg-white border p-3 shadow text-left hover:scale-[1.01] transition"><div className="text-lg">{o.ja} ({o.reading})</div></button>))}</div></div>)}</div>); }

        function Writing(){ const [target,setTarget]=useState(WORDS[0]); const canvasRef=useRef(null); const [drawing,setDrawing]=useState(false); useEffect(()=>{ const c=canvasRef.current; if(!c) return; const ctx=c.getContext('2d'); ctx.clearRect(0,0,c.width,c.height); ctx.lineWidth=6; ctx.lineCap='round'; ctx.strokeStyle='#111'; },[target]); function start(e){ setDrawing(true); draw(e);} function end(){ setDrawing(false); const c=canvasRef.current; c && c.getContext('2d').beginPath(); } function pos(e){ const c=canvasRef.current; const r=c.getBoundingClientRect(); const x=(e.clientX||e.touches?.[0]?.clientX)-r.left; const y=(e.clientY||e.touches?.[0]?.clientY)-r.top; return {x,y}; } function draw(e){ if(!drawing) return; const {x,y}=pos(e); const ctx=canvasRef.current.getContext('2d'); ctx.lineTo(x,y); ctx.stroke(); ctx.beginPath(); ctx.moveTo(x,y);} function clear(){ const c=canvasRef.current; const ctx=c.getContext('2d'); ctx.clearRect(0,0,c.width,c.height);} const guideChar=React.useMemo(()=> (scriptMode==="kanji"? target.ja : target.reading?.split('')?.[0] || target.ja), [target, scriptMode]); return (<div className="space-y-4"><div className="flex gap-2 items-center flex-wrap"><select className="border rounded-2xl px-3 py-2" value={target.id} onChange={e=>setTarget(WORDS.find(w=>w.id===parseInt(e.target.value)))}>{WORDS.map(w=><option key={w.id} value={w.id}>{w.ja} Â· {w.ko}</option>)}</select><button className="px-3 py-2 rounded-2xl border" onClick={()=>speakJA(target.ja)}>ğŸ”Š ë°œìŒ</button><div className="text-sm text-gray-600">ê°€ì´ë“œ: <span className="text-xl font-bold">{guideChar}</span></div></div><div className="grid md:grid-cols-[1fr,300px] gap-4 items-start"><div className="rounded-2xl bg-white border p-4 shadow"><canvas ref={canvasRef} width={600} height={400} onMouseDown={start} onMouseUp={end} onMouseMove={draw} onMouseLeave={end} onTouchStart={e=>{e.preventDefault(); start(e.touches[0]);}} onTouchMove={e=>{e.preventDefault(); draw(e.touches[0]);}} onTouchEnd={e=>{e.preventDefault(); end();}} className="w-full rounded-xl border bg-white" /><div className="flex gap-2 mt-2"><button className="px-3 py-2 rounded-2xl border" onClick={clear}>ì§€ìš°ê¸°</button></div></div><div className="rounded-2xl bg-white border p-4 shadow space-y-2"><div className="text-sm text-gray-500">ì“°ê¸° íŒíŠ¸</div><div className="text-sm text-gray-700">ê²©ì(ê°€ë¡œ/ì„¸ë¡œ ì¤‘ì•™ì„ )ë¥¼ ìƒìƒí•˜ê³  í° íšë¶€í„° ì“°ì„¸ìš”. ì‹¤ì œ íšìˆœì€ ë¬¸ìë§ˆë‹¤ ë‹¤ë¥´ë©°, ë³¸ ì•±ì€ íŠ¸ë ˆì´ì‹± ì—°ìŠµìš©ì…ë‹ˆë‹¤.</div><div className="text-sm text-gray-500">ë‹¨ì–´</div><div className="text-lg font-semibold">{target.ja} ({target.reading})</div><div className="text-sm text-gray-500">í•œêµ­ì–´</div><div>{target.ko}</div></div></div></div>); }

        function ProgressView(){ const learned=WORDS.filter(w=> state.learnedIds.includes(w.id)); const accuracy=(state.stats.correct+state.stats.wrong)? Math.round((state.stats.correct/(state.stats.correct+state.stats.wrong))*100):0; const last14=Array.from({length:14}).map((_,i)=>{ const d=new Date(); d.setDate(d.getDate()-(13-i)); return d.toISOString().slice(0,10);}); const weeklyGoal=50; const weeklyPct=Math.min(100, Math.round((state.week?.answers||0)/weeklyGoal*100)); return (<div className="space-y-4"><div className="grid md:grid-cols-4 gap-3"><div className="rounded-2xl bg-white border p-3 shadow text-center"><div className="text-sm text-gray-500">ì—°ì† ì¶œì„</div><div className="text-2xl font-bold">{`${state.streak}ì¼`}</div></div><div className="rounded-2xl bg-white border p-3 shadow text-center"><div className="text-sm text-gray-500">í•™ìŠµ ë‹¨ì–´</div><div className="text-2xl font-bold">{`${learned.length}/${WORDS.length}`}</div></div><div className="rounded-2xl bg-white border p-3 shadow text-center"><div className="text-sm text-gray-500">ì •ë‹µë¥ </div><div className="text-2xl font-bold">{`${accuracy}%`}</div></div><div className="rounded-2xl bg-white border p-3 shadow text-center"><div className="text-sm text-gray-500">ì£¼ê°„ í€´ì¦ˆ</div><div className="text-2xl font-bold">{`${state.week?.answers||0}/${weeklyGoal}`}</div></div></div><div className="rounded-2xl bg-white border p-4 shadow"><div className="text-sm text-gray-500 mb-1">ì£¼ê°„ ì±Œë¦°ì§€ ì§„í–‰ë„</div><div className="w-full h-3 bg-gray-200 rounded-full overflow-hidden"><div className="h-3 bg-black" style={{width: `${weeklyPct}%`}}></div></div><div className="text-xs text-gray-500 mt-1">ì´ë²ˆ ì£¼ {state.week?.answers||0} / {weeklyGoal}</div></div><div><div className="text-sm text-gray-500 mb-2">ìµœê·¼ 14ì¼ ì¶œì„</div><div className="grid grid-cols-14 gap-1">{last14.map(d=>(<div key={d} className={`h-6 rounded ${state.lastOpenDate && d <= state.lastOpenDate ? "bg-black" : "bg-gray-200"}`}></div>))}</div></div><div className="rounded-2xl bg-white border p-4 shadow"><div className="text-lg font-semibold mb-2">í•™ìŠµ ë‹¨ì–´ ëª©ë¡</div><div className="grid md:grid-cols-3 gap-2 max-h-64 overflow-auto pr-1">{learned.map(w=>(<div key={w.id} className="border rounded-xl p-2 text-sm"><div className="font-semibold">{w.ja} <span className="text-gray-500 text-xs">({w.reading})</span></div><div className="text-gray-600">{w.ko} Â· {w.romaji}</div></div>))}</div></div><button className="px-4 py-2 rounded-2xl bg-white border" onClick={()=>{ localStorage.removeItem(STORAGE_KEY); setState({ lastOpenDate:null, streak:0, learnedIds:[], dueMap:{}, stats:{correct:0,wrong:0,gamesWon:0}, week:{start:null,answers:0}, badges:[] }); }}>ì´ˆê¸°í™”(ë°ì´í„° ë¦¬ì…‹)</button></div>); }

        return (<div className="min-h-screen text-gray-900 p-4 md:p-8"><div className="max-w-5xl mx-auto"><header className="mb-6 flex items-center justify-between gap-3 flex-wrap"><div><h1 className="text-2xl md:text-3xl font-extrabold">æ—¥æœ¬èª í•™ìŠµ Â· ìƒì¥ & ì¹˜ì¦ˆ</h1><p className="text-gray-600">í•œêµ­ì–´ë¡œ ë°°ìš°ëŠ” ì¼ë³¸ì–´ Â· ì¶œì„ Â· í€´ì¦ˆ Â· ê²Œì„ Â· ì“°ê¸° ì—°ìŠµ Â· ë°°ì§€</p></div><div className="flex gap-2"><div className="rounded-2xl bg-white border p-3 shadow text-center"><div className="text-sm text-gray-500">ì—°ì†</div><div className="text-2xl font-bold">{`${state.streak}ì¼`}</div></div><div className="rounded-2xl bg-white border p-3 shadow text-center"><div className="text-sm text-gray-500">ì •ë‹µ</div><div className="text-2xl font-bold">{state.stats.correct}</div></div></div></header><div className="flex gap-2 mb-4 flex-wrap">{["í•™ìŠµ","í€´ì¦ˆ","ê²Œì„","ì“°ê¸°","ì§„í–‰ë„"].map(t=>(<button key={t} onClick={()=>setTab(t)} className={`px-4 py-2 rounded-2xl shadow ${tab===t?"bg-black text-white":"bg-white border"}`}>{t}</button>))}</div><main className="mt-2">{tab==="í•™ìŠµ" && <Learn/>}{tab==="í€´ì¦ˆ" && <Quiz/>}{tab==="ê²Œì„" && <Game/>}{tab==="ì“°ê¸°" && <Writing/>}{tab==="ì§„í–‰ë„" && <ProgressView/>}</main><footer className="mt-10 text-center text-xs text-gray-500">Â© {new Date().getFullYear()} JP Study â€“ GitHub Pages ë°°í¬ìš©</footer></div></div>);
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App/>);
    </script>
  </body>
</html>
